(function(m){'use strict';function q(){var c={};var g={closeButton:null,modal:null,overlay:null,defaults:{className:'fade-and-drop',closeButton:true,content:"",width:'600px',height:'480px',overlay:true}};var e={clickEvents:[]};var k={};var h={devmode:false,debug:false};k.startTime=function(){this._0=performance.now()}k.runTime=function(){this._1=performance.now();this._2=this._1-this._0;console.log('Execution time: '+this._2+' ms.')}e.initialize=function(){var d=/{mauticform([^}]+)}/g,n;while(n=d.exec(document.body.innerHTML)){var l=n[0];var f={data:{},params:''};var o=[];n[1].trim().split(/\s+/).forEach(function(a){var b=a.split('=');f.data[b[0]]=b[1];if(b[0]!='id')o.push(b[0]+'='+encodeURIComponent(b[1]))});o.push('html=1');f.params=o.join('&');f.data['replace']=l;f.data['style']=typeof(f.data['style'])=='undefined'?'embed':f.data['style'];if(c.debug())console.log(f.data['style']+' Mautic Form: '+l);switch(f.data['style']){case'modal':document.body.innerHTML=document.body.innerHTML.replace(l,'');e.clickEvents.push(f);break;case'embed':default:document.body.innerHTML=document.body.innerHTML.replace(l,this.createIframe(f).outerHTML);break}}this.bindClickEvents();k.runTime()}e.bindClickEvents=function(){if(c.debug())console.log('binding modal click events');for(var a in e.clickEvents){var b=e.clickEvents[a];document.querySelector(b.data.element).setAttribute("_3",a);document.querySelector(b.data.element).addEventListener("click",function(){if(c.debug())console.log('add event to '+b.data.element);e.openModal(e.clickEvents[this.getAttribute('_3')])})}}e.openModal=function(a){c.openModal({content:e.createIframe(a,true).outerHTML,width:typeof(a.data['width'])!='undefined'?a.data['width']:'600px',height:typeof(a.data['height'])!='undefined'?a.data['height']:'480px'})}e.getFormLink=function(a){var b=(c.devMode())?'index_dev.php':'index.php';return c.getMauticBaseUrl()+b+'/form/'+a.data['id']+'?'+a.params}e.createIframe=function(a,b){var b=(typeof(b)=='undefined')?false:true;var d=document.createElement('iframe');d.frameBorder=typeof(a.data['border'])!='undefined'?parseInt(a.data['border']):'0';d.width=(b)?'100%':typeof(a.data['width'])!='undefined'?a.data['width']:'600px';d.height=(b)?'100%':typeof(a.data['height'])!='undefined'?a.data['height']:'400px';d.className=(typeof(a.data['class'])=='string')?a.data['class']:'';d.src=this.getFormLink(a);return d}g.loadStyle=function(){if(typeof(h.modal_css)!='undefined'){if(c.debug())console.log('custom modal css style');return}var a=document.createElement('link');a.rel="stylesheet"a.type="text/css"a.href=c.debug()?c.getMauticBaseUrl()+'media/css/modal.css':c.getMauticBaseUrl()+'media/css/modal.min.css';document.head.appendChild(a)}g.open=function(){if(arguments[0]&&typeof arguments[0]==="object"){this.options=this.extendDefaults(this.defaults,arguments[0])}this.buildOut();this.initializeEvents();m.getComputedStyle(this.modal).height;this.modal.className=this.modal.className+(this.modal.offsetHeight>m.innerHeight?" mauticForm-open mauticForm-anchored":" mauticForm-open");this.overlay.className=this.overlay.className+" mauticForm-open"}g.buildOut=function(){var a,b,d;a=typeof(this.options.content)=='string'?this.options.content:this.options.content.innerHTML;d=document.createDocumentFragment();this.modal=document.createElement("div");this.modal.className="mauticForm-modal "+this.options.className;this.modal.style.width=this.options.width;this.modal.style.height=this.options.height;if(this.options.closeButton===true){this.closeButton=document.createElement("button");this.closeButton.className="mauticForm-close close-button";this.closeButton.innerHTML="&times;";this.modal.appendChild(this.closeButton)}if(this.options.overlay===true){this.overlay=document.createElement("div");this.overlay.className="mauticForm-overlay "+this.options.className;d.appendChild(this.overlay)}b=document.createElement("div");b.className="mauticForm-content";b.innerHTML=a;this.modal.appendChild(b);d.appendChild(this.modal);document.body.appendChild(d)}g.extendDefaults=function(a,b){for(var d in b){if(b.hasOwnProperty(d))a[d]=b[d]}return a}g.initializeEvents=function(){if(this.closeButton)this.closeButton.addEventListener('click',this.close.bind(this));if(this.overlay)this.overlay.addEventListener('click',this.close.bind(this))}g.transitionSelect=function(){var a=document.createElement("div");return(a.style.WebkitTransition)?"webkitTransitionEnd":(a.style.WebkitTransition)?"webkitTransitionEnd":"oTransitionEnd"}g.close=function(){var a=this;this.modal.className=this.modal.className.replace(" mauticForm-open","");this.overlay.className=this.overlay.className.replace(" mauticForm-open","");this.modal.addEventListener(this.transitionSelect(),function(){a.modal.parentNode.removeChild(a.modal)});this.overlay.addEventListener(this.transitionSelect(),function(){if(a.overlay.parentNode)a.overlay.parentNode.removeChild(a.overlay)})}c.parseToObject=function(a){return JSON.parse('{"'+decodeURI(a.trim().replace(/&/g,"\",\"").replace(/=/g,"\":\""))+'"}')}c.setConfig=function(a){h=a}c.getConfig=function(){return h}c.debug=function(){return typeof(h.debug)!='undefined'?true:false}c.devMode=function(){return typeof(h.devmode)!='undefined'?true:false}c.setMauticBaseUrl=function(a){h.mautic_base_url=a.split('/').slice(0,-3).join('/')+'/'}c.getMauticBaseUrl=function(){return h.mautic_base_url}c.initialize=function(b){k.startTime();if(c.debug())console.log('SDK initialized');if(typeof(h.mautic_base_url)=='undefined')c.setMauticBaseUrl(b);if(c.debug())console.log('Automatic setup mautic_base_url as: '+h.mautic_base_url);g.loadStyle();document.addEventListener("DOMContentLoaded",function(a){if(c.debug())console.log('DOM is ready');e.initialize()})}c.openModal=function(a){g.open(a)}return c}if(typeof(MauticSDK)==='undefined'){m.MauticSDK=q();var i=document.getElementsByTagName('script'),r=i.length;for(var j=0;j<i.length;j++){if(!i[j].hasAttribute('src')||i[j].getAttribute("src").indexOf('mautic-form.js')==-1)continue;var p=i[j].getAttribute("src").split("?");if(p[1])MauticSDK.setConfig(MauticSDK.parseToObject(p[1]));MauticSDK.initialize(p[0]);break}}})(window);