{"version":3,"sources":["webpack://grapesjs-preset-mautic/webpack/universalModuleDefinition","webpack://grapesjs-preset-mautic/webpack/bootstrap","webpack://grapesjs-preset-mautic/./node_modules/@babel/runtime/helpers/defineProperty.js","webpack://grapesjs-preset-mautic/./src/index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","obj","configurable","writable","editor","opts","am","AssetManager","pm","Panels","modal","Modal","cmd","Commands","cfg","getConfig","mjmlTemplate","plugins","includes","config","sourceEdit","sourceEditBtnLabel","sourceEditModalTitle","deleteAssetConfirmText","showLayersManager","showImportButton","addType","view","onRemove","e","stopPropagation","model","this","confirm","collection","remove","on","$","grapesjs","openTmBtn","getButton","set","openSm","removeButton","traitsSector","traitsProps","find","append","before","traitStyle","style","hidden","display","openBlocksBtn","pfx","stylePrefix","codeViewer","CodeManager","getViewer","clone","container","document","createElement","btnEdit","codeName","readOnly","theme","autoBeautify","autoCloseTags","autoCloseBrackets","lineWrapping","styleActiveLine","smartIndent","indentWithTabs","innerHTML","className","onclick","code","getValue","DomComponents","getWrapper","setComponents","trim","close","add","run","sender","content","viewer","setTitle","textarea","appendChild","init","getHtml","runCommand","setContent","open","refresh","addButton","id","command","attributes","title"],"mappings":"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","file":"grapesjs-preset-mautic.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"grapesjs-preset-mautic\"] = factory();\n\telse\n\t\troot[\"grapesjs-preset-mautic\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","export default (editor, opts = {}) => {\n    const am = editor.AssetManager;\n    const pm = editor.Panels;\n    const modal = editor.Modal;\n    const cmd = editor.Commands;\n    const cfg = editor.getConfig();\n\n    let mjmlTemplate = false;\n\n    // Check if MJML plugin is on\n    if (cfg.plugins.includes('grapesjs-mjml')) {\n        mjmlTemplate = true;\n    }\n\n    let config = {\n        sourceEdit: 1,\n        sourceEditBtnLabel: 'Edit',\n        sourceEditModalTitle: 'Edit code',\n        deleteAssetConfirmText: 'Are you sure?',\n        showLayersManager: 0,\n        showImportButton: 0,\n        ...opts,\n    };\n\n    // Extend the original `image` and add a confirm dialog before removing it\n    am.addType('image', {\n        // As you adding on top of an already defined type you can avoid indicating\n        // `am.getType('image').view.extend({...` the editor will do it by default\n        // but you can eventually extend some other type\n        view: {\n            // If you want to see more methods to extend check out\n            // https://github.com/artf/grapesjs/blob/dev/src/asset_manager/view/AssetImageView.js\n            onRemove(e) {\n                e.stopPropagation();\n                const model = this.model;\n\n                if (confirm(config.deleteAssetConfirmText)) {\n                    model.collection.remove(model);\n                }\n            }\n        },\n    });\n\n    editor.on('load', function() {\n        let $ = grapesjs.$;\n\n        // Load and show settings and style manager\n        let openTmBtn = pm.getButton('views', 'open-tm');\n        openTmBtn && openTmBtn.set('active', 1);\n        let openSm = pm.getButton('views', 'open-sm');\n        openSm && openSm.set('active', 1);\n\n        pm.removeButton(\"views\", \"open-tm\");\n\n        if (!config.showLayersManager) {\n            pm.removeButton(\"views\", \"open-layers\");\n        }\n\n        if (!config.showImportButton) {\n            if (mjmlTemplate) {\n                pm.removeButton(\"options\", \"mjml-import\");\n            } else {\n                pm.removeButton(\"options\", \"gjs-open-import-template\");\n            }\n        }\n\n        // Add Settings Sector\n        let traitsSector = $('<div class=\"gjs-sm-sector no-select\">'+\n            '<div class=\"gjs-sm-title\"><span class=\"icon-settings fa fa-cog\"></span> Settings</div>' +\n            '<div class=\"gjs-sm-properties\" style=\"display: none;\"></div></div>');\n        let traitsProps = traitsSector.find('.gjs-sm-properties');\n\n        traitsProps.append($('.gjs-trt-traits'));\n        $('.gjs-sm-sectors').before(traitsSector);\n        traitsSector.find('.gjs-sm-title').on('click', function(){\n            let traitStyle = traitsProps.get(0).style;\n            let hidden = traitStyle.display === 'none';\n\n            if (hidden) {\n                traitStyle.display = 'block';\n            } else {\n                traitStyle.display = 'none';\n            }\n        });\n\n        // Open block manager\n        let openBlocksBtn = editor.Panels.getButton('views', 'open-blocks');\n        openBlocksBtn && openBlocksBtn.set('active', 1);\n    });\n\n    // Add function within builder to edit source code\n    if (config.sourceEdit) {\n        let pfx = cfg.stylePrefix;\n        let codeViewer = editor.CodeManager.getViewer('CodeMirror').clone();\n        let container = document.createElement('div');\n        let btnEdit = document.createElement('button');\n\n        codeViewer.set({\n            codeName: 'htmlmixed',\n            readOnly: 0,\n            theme: 'hopscotch',\n            autoBeautify: true,\n            autoCloseTags: true,\n            autoCloseBrackets: true,\n            lineWrapping: true,\n            styleActiveLine: true,\n            smartIndent: true,\n            indentWithTabs: true\n        });\n\n        btnEdit.innerHTML = config.sourceEditBtnLabel;\n        btnEdit.className = pfx + 'btn-prim ' + pfx + 'btn-import';\n        btnEdit.onclick = function () {\n            let code = codeViewer.editor.getValue();\n            editor.DomComponents.getWrapper().set('content', '');\n            editor.setComponents(code.trim());\n            modal.close();\n        };\n\n        cmd.add('html-edit', {\n            run: function (editor, sender) {\n                sender && sender.set('active', 0);\n                let viewer = codeViewer.editor;\n                modal.setTitle(config.sourceEditModalTitle);\n\n                if (!viewer) {\n                    let textarea = document.createElement('textarea');\n                    container.appendChild(textarea);\n                    container.appendChild(btnEdit);\n                    codeViewer.init(textarea);\n                    viewer = codeViewer.editor;\n                }\n\n                let content;\n                if (mjmlTemplate) {\n                    content = editor.getHtml();\n                } else {\n                    content = editor.runCommand('gjs-get-inlined-html');\n                }\n\n                modal.setContent('');\n                modal.setContent(container);\n                codeViewer.setContent(content);\n                modal.open();\n                viewer.refresh();\n            }\n        });\n\n        pm.addButton('options', [\n            {\n                id: 'edit',\n                className: 'fa fa-edit',\n                command: 'html-edit',\n                attributes: {\n                    title: config.sourceEditModalTitle\n                }\n            }\n        ]);\n    }\n};\n"],"sourceRoot":""}